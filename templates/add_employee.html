{% extends 'layout.html' %}

{% block page_title %}Add Employee - Payroll Manager{% endblock %}

{% block dashboard_nav_class %}text-slate-300 rounded-lg hover:bg-slate-800{% endblock %}

{% block header_title %}Add Employee{% endblock %}

{% block header_subtitle %}Register a new employee in the system{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Messages -->
    {% if messages %}
        <div class="mb-6 space-y-2">
            {% for message in messages %}
                <div class="alert {% if message.tags == 'error' %}alert-error{% else %}alert-success{% endif %}">
                    <span>{{ message }}</span>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Form Card -->
    <div class="bg-slate-900 border border-slate-700 rounded-xl p-8">
        <h3 class="text-xl font-semibold text-white mb-6">Employee Information</h3>
        
        <form method="POST" class="space-y-6">
            {% csrf_token %}
            
            <!-- User Information Section -->
            <div class="space-y-4">
                <h4 class="text-lg font-medium text-white border-b border-slate-700 pb-2">User Account</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Username *</span>
                        </label>
                        {{ form.username }}
                        {% if form.username.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.username.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Email *</span>
                        </label>
                        {{ form.email }}
                        {% if form.email.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.email.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">First Name *</span>
                        </label>
                        {{ form.first_name }}
                        {% if form.first_name.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.first_name.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Last Name</span>
                        </label>
                        {{ form.last_name }}
                        {% if form.last_name.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.last_name.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Phone Number</span>
                        </label>
                        {{ form.phone_number }}
                        {% if form.phone_number.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.phone_number.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Password *</span>
                        </label>
                        {{ form.password }}
                        {% if form.password.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.password.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Employee Information Section -->
            <div class="space-y-4">
                <h4 class="text-lg font-medium text-white border-b border-slate-700 pb-2">Employee Details</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Job Role *</span>
                        </label>
                        <select name="{{ form.job_role.name }}" class="select select-bordered w-full bg-slate-800 text-white border-slate-600 focus:border-indigo-500 focus:outline-none" required>
                            <option value="" disabled selected>Select a job role</option>
                            {% for choice in form.job_role.field.queryset %}
                                <option value="{{ choice.id }}" {% if form.job_role.value == choice.id %}selected{% endif %} class="bg-slate-800 text-white">{{ choice.title }}{% if choice.department %} - {{ choice.department }}{% endif %}</option>
                            {% endfor %}
                        </select>
                        {% if form.job_role.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.job_role.errors.0 }}</span>
                            </label>
                        {% elif not form.job_role.field.queryset.exists %}
                            <label class="label">
                                <span class="label-text-alt text-yellow-400">No job roles available. Please create job roles in the admin panel first.</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Date of Joining *</span>
                        </label>
                        {{ form.date_of_joining }}
                        {% if form.date_of_joining.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.date_of_joining.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control md:col-span-2">
                        <label class="label">
                            <span class="label-text text-slate-300">Base Salary *</span>
                        </label>
                        {{ form.salary_base }}
                        {% if form.salary_base.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.salary_base.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Bank Details Section -->
            <div class="space-y-4">
                <h4 class="text-lg font-medium text-white border-b border-slate-700 pb-2">Bank Information</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Bank Name *</span>
                        </label>
                        {{ form.bank_name }}
                        {% if form.bank_name.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.bank_name.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">Account Number *</span>
                        </label>
                        {{ form.account_number }}
                        {% if form.account_number.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.account_number.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                    
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text text-slate-300">IFSC Code</span>
                        </label>
                        {{ form.ifsc_code }}
                        {% if form.ifsc_code.errors %}
                            <label class="label">
                                <span class="label-text-alt text-red-400">{{ form.ifsc_code.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="flex items-center justify-end space-x-4 pt-6 border-t border-slate-700">
                <a href="{% url 'list_employees' %}" class="btn btn-ghost text-slate-300 hover:text-white">
                    Cancel
                </a>
                <button type="submit" class="btn btn-primary bg-indigo-600 hover:bg-indigo-700 text-white">
                    Add Employee
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

